import Head from 'next/head';
import Card from './components/card';
import PocketBase from 'pocketbase';
import { useState, useEffect, useRef } from 'react';

export default function Home() {
  const [data, setData] = useState("");
  const [post, setPost] = useState([]);
  const [file, setFile] = useState(null);
  const fileInputRef = useRef(null);

  const pb = new PocketBase('http://127.0.0.1:8090');
  const collection = pb.collection('posts');

  const addData = async () => {
    try {
      const formData = new FormData();
      formData.append('text', data);
      formData.append('image', file);
      const record = await pb.collection('posts').create(formData);
      alert('Data added successfully!');
      setData('');
      setFile(null);
      console.log(record);
    } catch (error) {
      console.error(error);
    }
  };

  const handleFileInputChange = (event) => {
    setFile(event.target.files[0]);
  };

 // useEffect(() => {
 //   const fetchData = async () => {
 //     const resultList = await pb.collection('posts').getList(1, 50, {
 //       $autoCancel: false,
 //       filter: 'created >= "2022-01-01 00:00:00"',
 //     });

 //     setPost(resultList.items);
 //     console.log("post:",post)
 //   };
 //   fetchData();
 // }, []);
    const getImageUrl = (post) => {
    if (!post.image) {
      return null;
    }
    const firstFilename = post.image;

    return pb.getFileUrl(post, firstFilename, {'thumb': '100x250'});
  }

  const json = {
    "text":"จัดการข้อมูลที่ได้รับมาและนำมาทดสอบโดยการแสดงกราฟ",
    "image":["https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/DOsturation.png?raw=true",
    "https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/chorlophyl.png?raw=true",
    "https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/conduct.png?raw=true",
    "https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/salinity.png?raw=true",
    "https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/seatemp.png?raw=true",
      "https://github.com/dazcalifornia/waterQuality/blob/main/audit/assets/images/tubidity.png?raw=true"]
}

  return (
    <div className='bg'>
      <Head>
        <title>Audit Page</title>
        <meta name="description" content="Generated by create next app" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <h1>Post Update</h1>

      <section className='feed-container'>
       
         <Card post={json} />
      </section>
    </div>
  );
}
